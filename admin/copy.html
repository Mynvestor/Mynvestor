<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mynvestor Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Merged CSS from investor.html and broker.html, prioritizing broker's enhanced styling */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', sans-serif;
        }
        /* Enhanced Card Text Visibility */
.card {
    overflow: hidden; /* Prevent content from overflowing card */
}

.card-title, .card-text, .form-label, .table th, .table td {
    overflow-wrap: break-word; /* Ensure long words wrap */
    white-space: normal; /* Allow text to wrap naturally */
    color: #d0d4d6; /* Consistent text color for readability */
}

.card-title {
    color: #fff; /* High contrast for titles */
    line-height: 1.4; /* Improve readability */
    margin-bottom: 0.75rem;
}

.card-text {
    line-height: 1.6; /* Better spacing for descriptions */
    margin-bottom: 1rem;
}

.form-label {
    font-size: 0.95rem; /* Slightly larger for clarity */
    margin-bottom: 0.5rem;
}

.form-control.bg-dark, .form-select.bg-dark {
    font-size: 1rem; /* Ensure input text is readable */
    padding: 0.5rem 0.75rem; /* Adequate padding */
    color: #d0d4d6; /* High contrast */
}

.table th, .table td {
    padding: 0.75rem; /* More padding for table cells */
    font-size: 0.9rem; /* Readable font size */
    line-height: 1.5; /* Prevent cramped text */
}

.table-responsive {
    overflow-x: auto; /* Allow horizontal scrolling if needed */
}

/* Ensure table text wraps in notification table */
#notificationTable td, #notificationTable th {
    min-width: 100px; /* Prevent columns from being too narrow */
    max-width: 300px; /* Limit width to encourage wrapping */
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .card-body {
        padding: 1rem; /* Maintain padding on mobile */
    }

    .form-label, .card-text {
        font-size: 0.9rem; /* Slightly smaller on mobile but still readable */
    }

    .table th, .table td {
        font-size: 0.85rem; /* Adjust for mobile */
        padding: 0.5rem; /* Slightly less padding */
    }

    .form-control.bg-dark, .form-select.bg-dark {
        font-size: 0.95rem; /* Adjust input size */
    }

    #notificationTable td, #notificationTable th {
        min-width: 80px; /* Adjust for smaller screens */
    }
}

@media (min-width: 769px) {
    .card-body {
        padding: 1.5rem; /* More padding on desktop */
    }
}
/* Settings Section Enhancements */
.form-check-input:checked {
    background-color: #28a745;
    border-color: #28a745;
}

.form-select[multiple] {
    height: 120px;
}

.form-control.bg-dark, .form-select.bg-dark {
    background: #2c3034;
    color: #d0d4d6;
    border: 1px solid #5a6268;
}

.form-control.bg-dark:focus, .form-select.bg-dark:focus {
    border-color: #28a745;
    box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.25);
}
        body {
            background: #454e55;
            padding: 60px 0 80px;
            min-height: 100vh;
            color: #d0d4d6;
        }
/* Compliance Section Enhancements */
.card .badge {
    font-size: 0.85rem;
    padding: 0.4em 0.8em;
}

.table-responsive {
    max-height: 400px;
    overflow-y: auto;
}

.table th, .table td {
    vertical-align: middle;
}

.form-select.bg-dark:focus, .form-control.bg-dark:focus {
    border-color: #28a745;
    box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.25);
}
        /* Sidebar styling */
        .sidebar {
            position: fixed;
            top: 60px;
            left: 0;
            width: 200px;
            height: calc(100vh - 60px);
            background: #001f3f;
            padding: 20px;
            z-index: 999;
            transition: transform 0.3s ease;
        }

        .sidebar-nav {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .sidebar .nav-item {
            display: flex;
            align-items: center;
            color: #fff;
            text-decoration: none;
            font-size: 1rem;
            padding: 10px;
            border-radius: 5px;
            transition: background 0.2s, transform 0.2s;
        }

        .sidebar .nav-item:hover {
            background: #003366;
            transform: translateX(5px);
        }

        .sidebar .nav-item.active {
            background: #003366;
            color: #28a745;
        }

        .sidebar .nav-icon {
            font-size: 20px;
            margin-right: 10px;
        }

        /* Top-nav styling */
        .top-nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: #001f3f;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: #fff;
            z-index: 1000;
        }

        .profile-pic {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid #fff;
            transition: transform 0.2s;
        }

        .profile-pic:hover {
            transform: scale(1.1);
        }

        .profile-initials {
            width: 100%;
            height: 100%;
            background: #28a745;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: 700;
        }

        .company-name {
            font-size: 1.4rem;
            font-weight: 700;
        }

        .jon {
            color: #24ac44;
        }

        .more-icon {
            cursor: pointer;
            padding: 8px;
            color: #fff;
            font-size: 24px;
            transition: transform 0.2s, color 0.2s;
        }

        .more-icon:hover {
            transform: scale(1.1);
        }

        .more-icon.active {
            color: #28a745;
        }

        /* Dropdown menu for more options */
        .dropdown-menu {
            background: linear-gradient(145deg, #2c3034 0%, #1a1e22 100%);
            border: 1px solid #5a6268;
            color: #d0d4d6;
        }

        .dropdown-menu .dropdown-item {
            color: #d0d4d6;
            font-weight: 500;
            padding: 8px 16px;
            transition: background 0.2s, color 0.2s;
            display: flex;
            align-items: center;
        }

        .dropdown-menu .dropdown-item i {
            margin-right: 8px;
            font-size: 1.1rem;
        }

        .dropdown-menu .dropdown-item:hover {
            background: #003366;
            color: #28a745;
        }

        .dropdown-menu .dropdown-item.active {
            background: #003366;
            color: #28a745;
            font-weight: 600;
        }

        /* Content sections */
        .content-section {
            display: none;
            padding: 20px 20px 80px;
            min-height: calc(100vh - 160px);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            position: absolute;
            top: 60px;
            left: 0;
            right: 0;
        }

        .content-section.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .content-section h1 {
            color: #fff;
            font-weight: 600;
            font-size: 1.8rem;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
        }

        .loading {
            color: #28a745;
            font-style: italic;
            font-weight: 500;
            display: none;
        }

        /* Footer-nav for mobile */
        .footer-nav {
            position: fixed;
            bottom: 0;
            width: 100%;
            background: #001f3f;
            padding: 10px 0;
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-top: 1px solid #00284f;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #fff;
            text-decoration: none;
            font-size: 0.8rem;
            font-weight: 500;
            transition: transform 0.2s;
            padding: 5px;
        }

        .nav-item:hover {
            transform: translateY(-3px);
        }

        .nav-item.active {
            color: #28a745;
            background: #003366;
            border-radius: 5px;
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 6px;
            color: inherit;
        }

        /* Card styling */
        .card {
            background: linear-gradient(145deg, #2c3034 0%, #1a1e22 100%);
            border: 1px solid #5a6268;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            margin-bottom: 1rem;
        }

        .card-body {
            padding: 1rem;
        }

        .card-title {
            color: #fff;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
        }

        .card-text, .card-body p, .card-body span {
            color: #d0d4d6;
            font-weight: 500;
            font-size: 1rem;
        }

        /* Table styling */
        .table-dark {
            background: linear-gradient(145deg, #2c3034 0%, #1a1e22 100%);
            border: 1px solid #5a6268;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .table-dark th {
            background: linear-gradient(145deg, #212529 0%, #1a1e22 100%);
            color: #fff;
            font-weight: 600;
            font-size: 0.95rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .table-dark td {
            color: #d0d4d6;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .table-dark .badge {
            font-weight: 500;
            font-size: 0.85rem;
        }

        /* Modal styling */
        .modal-content.bg-dark {
            background: linear-gradient(145deg, #2c3034 0%, #1a1e22 100%);
            border: 1px solid #5a6268;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            color: #fff;
        }

        .modal-header, .modal-footer {
            border-color: #5a6268;
            padding: 0.75rem;
        }

        .modal-title {
            color: #fff;
            font-weight: 600;
        }

        .modal-body p, .modal-body label {
            color: #d0d4d6;
            font-weight: 500;
        }

        .btn-primary {
            background: linear-gradient(145deg, #17a2b8 0%, #138496 100%);
            border: none;
            font-weight: 500;
            color: #fff;
        }

        .btn-primary:hover {
            background: linear-gradient(145deg, #138496 0%, #117a8b 100%);
        }

        /* Form inputs for visibility */
        .form-control.bg-dark, .form-select.bg-dark {
            background: #2c3034;
            color: #d0d4d6;
            border: 1px solid #5a6268;
            font-weight: 500;
        }

        .form-control.bg-dark::placeholder {
            color: #adb5bd;
            font-weight: 400;
        }

        /* Responsive design */
        @media (min-width: 769px) {
            .footer-nav {
                display: none !important;
            }

            .sidebar {
                transform: translateX(0);
            }

            .content-section {
                margin-left: 200px;
                width: calc(100% - 200px);
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .content-section {
                margin-left: 0;
                width: 100%;
            }

            .footer-nav {
                display: flex;
            }
        }
    </style>
</head>

<body>
    <!-- Sidebar with 6 links -->
    <aside class="sidebar" id="sidebar">
        <nav class="sidebar-nav">
            <a href="#dashboard" class="nav-item active" title="View Dashboard" aria-label="Dashboard">
                <i class="bi bi-speedometer2 nav-icon"></i>Dashboard
            </a>
            <a href="#users" class="nav-item" title="Manage Users" aria-label="Users">
                <i class="bi bi-people nav-icon"></i>Users
            </a>
            <a href="#transactions" class="nav-item" title="View Transactions" aria-label="Transactions">
                <i class="bi bi-receipt nav-icon"></i>Transactions
            </a>
            <a href="#orders" class="nav-item" title="Manage Orders" aria-label="Orders">
                <i class="bi bi-cart nav-icon"></i>Orders
            </a>
            <a href="#market" class="nav-item" title="Manage Market Data" aria-label="Market">
                <i class="bi bi-graph-up nav-icon"></i>Market
            </a>
            <a href="#settings" class="nav-item" title="Platform Settings" aria-label="Settings">
                <i class="bi bi-gear nav-icon"></i>Settings
            </a>
        </nav>
    </aside>

    <!-- Top navigation with dropdown for Compliance, Learn, Help -->
    <nav class="top-nav">
        <div class="profile-pic" id="profile-pic-container">
            <div class="profile-initials" id="user-initials">AD</div>
        </div>
        <div class="company-name"><span class="jon">Myn</span>vestor Admin</div>
        <div class="dropdown">
            <i class="bi bi-three-dots more-icon" id="more-icon" data-bs-toggle="dropdown" aria-label="More Options"></i>
            <ul class="dropdown-menu dropdown-menu-end">
                <li><a class="dropdown-item" href="#compliance"><i class="bi bi-shield-check"></i>Compliance</a></li>
                <li><a class="dropdown-item" href="#learn"><i class="bi bi-book"></i>Learn</a></li>
                <li><a class="dropdown-item" href="#help"><i class="bi bi-question-circle"></i>Help</a></li>
            </ul>
        </div>
    </nav>

    <!-- Dashboard Section (Empty) -->
    <section id="dashboard" class="content-section active">
        <div class="loading" id="dashboard-loading">Loading...</div>
        <h1 class="mb-2"><i class="bi bi-speedometer2 me-2"></i>Dashboard</h1>
        <!-- Content to be added later -->
    </section>

    <!-- Users Section (Empty) -->
    <section id="users" class="content-section">
        <div class="loading" id="users-loading">Loading...</div>
        <h1 class="mb-2"><i class="bi bi-people me-2"></i>Users</h1>
        <!-- Content to be added later -->
    </section>

    <!-- Transactions Section (Empty) -->
    <section id="transactions" class="content-section">
        <div class="loading" id="transactions-loading">Loading...</div>
        <h1 class="mb-2"><i class="bi bi-receipt me-2"></i>Transactions</h1>
        <!-- Content to be added later -->
    </section>

    <!-- Orders Section (Empty) -->
    <section id="orders" class="content-section">
        <div class="loading" id="orders-loading">Loading...</div>
        <h1 class="mb-2"><i class="bi bi-cart me-2"></i>Orders</h1>
        <!-- Content to be added later -->
    </section>

    <!-- Market Section (Empty) -->
    <section id="market" class="content-section">
        <div class="loading" id="market-loading">Loading...</div>
        <h1 class="mb-2"><i class="bi bi-graph-up me-2"></i>Market</h1>
        <!-- Content to be added later -->
    </section>

<!-- Settings Section -->
<section id="settings" class="content-section">
    <div class="loading" id="settings-loading">Loading...</div>
    <h1 class="mb-2"><i class="bi bi-gear me-2"></i>Settings</h1>

    <!-- Commission Rates Card -->
    <div class="card mb-2">
        <div class="card-body">
            <h2 class="card-title"><i class="bi bi-currency-dollar me-2"></i>Commission Rates</h2>
            <p class="card-text">Set and adjust broker commission rates, order fees, VAT, and capital gains tax.</p>
            <form id="commissionForm" class="row g-3">
                <div class="col-md-3">
                    <label for="brokerCommission" class="form-label">Broker Commission (%)</label>
                    <input type="number" class="form-control bg-dark" id="brokerCommission" min="0" max="100" step="0.01" value="0.5" required>
                </div>
                <div class="col-md-3">
                    <label for="orderFee" class="form-label">Order Fee ($)</label>
                    <input type="number" class="form-control bg-dark" id="orderFee" min="0" step="0.01" value="1.00" required>
                </div>
                <div class="col-md-3">
                    <label for="vatTax" class="form-label">VAT Tax (%)</label>
                    <input type="number" class="form-control bg-dark" id="vatTax" min="0" max="100" step="0.01" value="5.0" required>
                </div>
                <div class="col-md-3">
                    <label for="capitalGainsTax" class="form-label">Capital Gains Tax (%)</label>
                    <input type="number" class="form-control bg-dark" id="capitalGainsTax" min="0" max="100" step="0.01" value="15.0" required>
                </div>
                <div class="col-12">
                    <button type="submit" class="btn btn-primary"><i class="bi bi-save me-2"></i>Update Rates</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Trading and Transfer Limits Card -->
    <div class="card mb-2">
        <div class="card-body">
            <h2 class="card-title"><i class="bi bi-limit me-2"></i>Trading and Transfer Limits</h2>
            <p class="card-text">Define limits for investor trades and fund transfers.</p>
            <form id="limitsForm" class="row g-3">
                <div class="col-md-4">
                    <label for="maxOrderSize" class="form-label">Max Order Size ($)</label>
                    <input type="number" class="form-control bg-dark" id="maxOrderSize" min="0" step="1" value="100000" required>
                </div>
                <div class="col-md-4">
                    <label for="dailyVolume" class="form-label">Daily Trade Volume ($)</label>
                    <input type="number" class="form-control bg-dark" id="dailyVolume" min="0" step="1" value="500000" required>
                </div>
                <div class="col-md-4">
                    <label for="ordersPerDay" class="form-label">Orders per Day</label>
                    <input type="number" class="form-control bg-dark" id="ordersPerDay" min="0" step="1" value="50" required>
                </div>
                <div class="col-md-4">
                    <label for="transfersPerDay" class="form-label">Transfers per Day</label>
                    <input type="number" class="form-control bg-dark" id="transfersPerDay" min="0" step="1" value="5" required>
                </div>
                <div class="col-md-4">
                    <label for="transactionVolume" class="form-label">Daily Transfer Volume ($)</label>
                    <input type="number" class="form-control bg-dark" id="transactionVolume" min="0" step="1" value="10000" required>
                </div>
                <div class="col-md-4">
                    <label for="transactionValue" class="form-label">Max Transfer Value ($)</label>
                    <input type="number" class="form-control bg-dark" id="transactionValue" min="0" step="1" value="5000" required>
                </div>
                <div class="col-12">
                    <button type="submit" class="btn btn-primary"><i class="bi bi-save me-2"></i>Update Limits</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Notification Settings Card -->
    <div class="card mb-2">
        <div class="card-body">
            <h2 class="card-title"><i class="bi bi-bell me-2"></i>Notification Settings</h2>
            <p class="card-text">Configure system notifications for admins, brokers, and investors.</p>
            <div class="table-responsive">
                <table class="table table-dark table-hover" id="notificationTable">
                    <thead>
                        <tr>
                            <th>Notification Type</th>
                            <th>Admins</th>
                            <th>Brokers</th>
                            <th>Investors</th>
                        </tr>
                    </thead>
                    <tbody id="notificationTableBody">
                        <tr data-notification-type="kyc-status">
                            <td>KYC Status Updates</td>
                            <td><input type="checkbox" class="form-check-input notification-toggle" data-role="admin" checked></td>
                            <td><input type="checkbox" class="form-check-input notification-toggle" data-role="broker"></td>
                            <td><input type="checkbox" class="form-check-input notification-toggle" data-role="investor" checked></td>
                        </tr>
                        <tr data-notification-type="order-updates">
                            <td>Order Updates</td>
                            <td><input type="checkbox" class="form-check-input notification-toggle" data-role="admin"></td>
                            <td><input type="checkbox" class="form-check-input notification-toggle" data-role="broker" checked></td>
                            <td><input type="checkbox" class="form-check-input notification-toggle" data-role="investor" checked></td>
                        </tr>
                        <tr data-notification-type="transfers">
                            <td>Fund Transfers</td>
                            <td><input type="checkbox" class="form-check-input notification-toggle" data-role="admin" checked></td>
                            <td><input type="checkbox" class="form-check-input notification-toggle" data-role="broker"></td>
                            <td><input type="checkbox" class="form-check-input notification-toggle" data-role="investor" checked></td>
                        </tr>
                        <tr data-notification-type="user-queries">
                            <td>User Queries</td>
                            <td><input type="checkbox" class="form-check-input notification-toggle" data-role="admin" checked></td>
                            <td><input type="checkbox" class="form-check-input notification-toggle" data-role="broker" checked></td>
                            <td><input type="checkbox" class="form-check-input notification-toggle" data-role="investor"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <button class="btn btn-primary mt-2" id="saveNotifications"><i class="bi bi-save me-2"></i>Save Notification Settings</button>
        </div>
    </div>

    <!-- KYC Levels Card -->
    <div class="card mb-2">
        <div class="card-body">
            <h2 class="card-title"><i class="bi bi-person-check me-2"></i>KYC Levels</h2>
            <p class="card-text">Adjust KYC requirements and verification thresholds.</p>
            <form id="kycLevelsForm" class="row g-3">
                <div class="col-md-6">
                    <label for="requiredDocuments" class="form-label">Required Documents</label>
                    <select class="form-select bg-dark" id="requiredDocuments" multiple required>
                        <option value="id" selected>Government ID</option>
                        <option value="address" selected>Proof of Address</option>
                        <option value="bank">Bank Statement</option>
                        <option value="selfie">Selfie with ID</option>
                    </select>
                </div>
                <div class="col-md-6">
                    <label for="fileFormats" class="form-label">Accepted File Formats</label>
                    <select class="form-select bg-dark" id="fileFormats" multiple required>
                        <option value="pdf" selected>PDF</option>
                        <option value="jpg" selected>JPG</option>
                        <option value="png" selected>PNG</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="validityPeriod" class="form-label">Document Validity (days)</label>
                    <input type="number" class="form-control bg-dark" id="validityPeriod" min="1" value="180" required>
                </div>
                <div class="col-md-4">
                    <label for="verificationThreshold" class="form-label">Verification Threshold (%)</label>
                    <input type="number" class="form-control bg-dark" id="verificationThreshold" min="0" max="100" step="1" value="80" required>
                </div>
                <div class="col-md-4">
                    <label for="maxFileSize" class="form-label">Max File Size (MB)</label>
                    <input type="number" class="form-control bg-dark" id="maxFileSize" min="1" step="1" value="5" required>
                </div>
                <div class="col-12">
                    <button type="submit" class="btn btn-primary"><i class="bi bi-save me-2"></i>Update KYC Levels</button>
                </div>
            </form>
        </div>
    </div>
</section>

<!-- Compliance Section -->
<section id="compliance" class="content-section">
    <div class="loading" id="compliance-loading">Loading...</div>
    <h1 class="mb-2"><i class="bi bi-shield-check me-2"></i>Compliance</h1>

    <!-- KYC Compliance Card -->
    <div class="card mb-2">
        <div class="card-body">
            <h2 class="card-title"><i class="bi bi-person-check me-2"></i>KYC Compliance</h2>
            <p class="card-text">Monitor KYC completion rates and flag incomplete or suspicious profiles.</p>
            <div class="d-flex justify-content-between mb-2">
                <div class="kyc-search">
                    <input type="text" class="form-control bg-dark" placeholder="Search users..." aria-label="Search users">
                </div>
                <div>
                    <span class="badge bg-success me-2">Completion Rate: <span id="kyc-completion-rate">0%</span></span>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#reviewKYCModal"><i class="bi bi-eye me-2"></i>Review KYC</button>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table table-dark table-hover" id="kycTable">
                    <thead>
                        <tr>
                            <th>User ID</th>
                            <th>Name</th>
                            <th>Status</th>
                            <th>Flags</th>
                            <th>Last Updated</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="kycTableBody">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Sanctions Screening Card -->
    <div class="card mb-2">
        <div class="card-body">
            <h2 class="card-title"><i class="bi bi-shield-exclamation me-2"></i>Sanctions Screening</h2>
            <p class="card-text">Check users against PEP/sanctions lists.</p>
            <div class="d-flex justify-content-between mb-2">
                <div class="sanctions-search">
                    <input type="text" class="form-control bg-dark" placeholder="Search flagged users..." aria-label="Search flagged users">
                </div>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#reviewSanctionsModal"><i class="bi bi-eye me-2"></i>Review Flagged Users</button>
            </div>
            <div class="table-responsive">
                <table class="table table-dark table-hover" id="sanctionsTable">
                    <thead>
                        <tr>
                            <th>User ID</th>
                            <th>Name</th>
                            <th>Flag Type</th>
                            <th>Details</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="sanctionsTableBody">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Report Generation Card -->
    <div class="card mb-2">
        <div class="card-body">
            <h2 class="card-title"><i class="bi bi-file-earmark-text me-2"></i>Report Generation</h2>
            <p class="card-text">Export reports on transactions, orders, user activity, or compliance status.</p>
            <form id="reportForm" class="row g-3">
                <div class="col-md-4">
                    <label for="reportType" class="form-label">Report Type</label>
                    <select class="form-select bg-dark" id="reportType" required>
                        <option value="transactions">Transactions</option>
                        <option value="orders">Orders</option>
                        <option value="user-activity">User Activity</option>
                        <option value="compliance">Compliance Status</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="reportFormat" class="form-label">Format</label>
                    <select class="form-select bg-dark" id="reportFormat" required>
                        <option value="csv">CSV</option>
                        <option value="pdf">PDF</option>
                    </select>
                </div>
                <div class="col-md-4 align-self-end">
                    <button type="submit" class="btn btn-primary w-100"><i class="bi bi-download me-2"></i>Generate Report</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Audit Logs Card -->
    <div class="card mb-2">
        <div class="card-body">
            <h2 class="card-title"><i class="bi bi-journal-text me-2"></i>Audit Logs</h2>
            <p class="card-text">Track all admin actions for traceability.</p>
            <div class="d-flex justify-content-between mb-2">
                <div class="audit-search">
                    <input type="text" class="form-control bg-dark" placeholder="Search audit logs..." aria-label="Search audit logs">
                </div>
            </div>
            <div class="table-responsive">
                <table class="table table-dark table-hover" id="auditTable">
                    <thead>
                        <tr>
                            <th>Log ID</th>
                            <th>Admin ID</th>
                            <th>Action</th>
                            <th>Details</th>
                            <th>Timestamp</th>
                        </tr>
                    </thead>
                    <tbody id="auditTableBody">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>

    <!-- Help Section -->
    <section id="help" class="content-section">
        <div class="loading" id="help-loading">Loading...</div>
        <h1 class="mb-2"><i class="bi bi-question-circle me-2"></i>Help Articles</h1>
        <div class="d-flex justify-content-between mb-2">
            <div class="help-search">
                <input type="text" class="form-control bg-dark" placeholder="Search help articles..." aria-label="Search help articles">
            </div>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addHelpArticleModal"><i class="bi bi-plus-circle me-2"></i>Add Article</button>
        </div>
        <div class="card mb-2">
            <div class="card-body">
                <h2 class="card-title"><i class="bi bi-question-circle me-2"></i>Manage Help Articles</h2>
                <div class="table-responsive">
                    <table class="table table-dark table-hover" id="helpTable">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Category</th>
                                <th>Audience</th>
                                <th>Updated</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="helpTableBody">
                            <tr data-article-id="H001">
                                <td>How to Verify KYC</td>
                                <td>Account Setup</td>
                                <td>Investor</td>
                                <td>2025-04-10</td>
                                <td>
                                    <button class="btn btn-primary btn-sm me-1 edit-help-btn" data-bs-toggle="modal" data-bs-target="#editHelpArticleModal"><i class="bi bi-pencil"></i> Edit</button>
                                    <button class="btn btn-danger btn-sm delete-help-btn"><i class="bi bi-trash"></i> Delete</button>
                                </td>
                            </tr>
                            <tr data-article-id="H002">
                                <td>Managing Client Orders</td>
                                <td>Trading</td>
                                <td>Broker</td>
                                <td>2025-04-09</td>
                                <td>
                                    <button class="btn btn-primary btn-sm me-1 edit-help-btn" data-bs-toggle="modal" data-bs-target="#editHelpArticleModal"><i class="bi bi-pencil"></i> Edit</button>
                                    <button class="btn btn-danger btn-sm delete-help-btn"><i class="bi bi-trash"></i> Delete</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Learn Section -->
    <section id="learn" class="content-section">
        <div class="loading" id="learn-loading">Loading...</div>
        <h1 class="mb-2"><i class="bi bi-book me-2"></i>Learn Content</h1>
        <div class="d-flex justify-content-between mb-2">
            <div class="learn-search">
                <input type="text" class="form-control bg-dark" placeholder="Search learn content..." aria-label="Search learn content">
            </div>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addLearnArticleModal"><i class="bi bi-plus-circle me-2"></i>Add Content</button>
        </div>
        <div class="card mb-2">
            <div class="card-body">
                <h2 class="card-title"><i class="bi bi-book me-2"></i>Manage Learn Content</h2>
                <div class="table-responsive">
                    <table class="table table-dark table-hover" id="learnTable">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Category</th>
                                <th>Updated</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="learnTableBody">
                            <tr data-content-id="L001">
                                <td>Introduction to Investing</td>
                                <td>Beginner</td>
                                <td>2025-04-08</td>
                                <td>
                                    <button class="btn btn-primary btn-sm me-1 edit-learn-btn" data-bs-toggle="modal" data-bs-target="#editLearnArticleModal"><i class="bi bi-pencil"></i> Edit</button>
                                    <button class="btn btn-danger btn-sm delete-learn-btn"><i class="bi bi-trash"></i> Delete</button>
                                </td>
                            </tr>
                            <tr data-content-id="L002">
                                <td>Understanding Stocks</td>
                                <td>Intermediate</td>
                                <td>2025-04-07</td>
                                <td>
                                    <button class="btn btn-primary btn-sm me-1 edit-learn-btn" data-bs-toggle="modal" data-bs-target="#editLearnArticleModal"><i class="bi bi-pencil"></i> Edit</button>
                                    <button class="btn btn-danger btn-sm delete-learn-btn"><i class="bi bi-trash"></i> Delete</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer navigation for mobile (6 links) -->
    <nav class="footer-nav">
        <a href="#dashboard" class="nav-item active" title="View Dashboard" aria-label="Dashboard">
            <i class="bi bi-speedometer2 nav-icon"></i>Dashboard
        </a>
        <a href="#users" class="nav-item" title="Manage Users" aria-label="Users">
            <i class="bi bi-people nav-icon"></i>Users
        </a>
        <a href="#transactions" class="nav-item" title="View Transactions" aria-label="Transactions">
            <i class="bi bi-receipt nav-icon"></i>Transactions
        </a>
        <a href="#orders" class="nav-item" title="Manage Orders" aria-label="Orders">
            <i class="bi bi-cart nav-icon"></i>Orders
        </a>
        <a href="#market" class="nav-item" title="Manage Market Data" aria-label="Market">
            <i class="bi bi-graph-up nav-icon"></i>Market
        </a>
        <a href="#settings" class="nav-item" title="Platform Settings" aria-label="Settings">
            <i class="bi bi-gear nav-icon"></i>Settings
        </a>
    </nav>

    <!-- Add Help Article Modal -->
    <div class="modal fade" id="addHelpArticleModal" tabindex="-1" aria-labelledby="addHelpArticleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-dark">
                <div class="modal-header">
                    <h5 class="modal-title" id="addHelpArticleModalLabel">Add Help Article</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addHelpArticleForm">
                        <div class="mb-3">
                            <label for="helpTitle" class="form-label">Title</label>
                            <input type="text" class="form-control bg-dark" id="helpTitle" required>
                        </div>
                        <div class="mb-3">
                            <label for="helpCategory" class="form-label">Category</label>
                            <select class="form-select bg-dark" id="helpCategory" required>
                                <option value="Account Setup">Account Setup</option>
                                <option value="Trading">Trading</option>
                                <option value="Payments">Payments</option>
                                <option value="Technical">Technical</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="helpAudience" class="form-label">Audience</label>
                            <select class="form-select bg-dark" id="helpAudience" required>
                                <option value="Investor">Investor</option>
                                <option value="Broker">Broker</option>
                                <option value="Both">Both</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="helpContent" class="form-label">Content</label>
                            <textarea class="form-control bg-dark" id="helpContent" rows="5" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Add Article</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Help Article Modal -->
    <div class="modal fade" id="editHelpArticleModal" tabindex="-1" aria-labelledby="editHelpArticleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-dark">
                <div class="modal-header">
                    <h5 class="modal-title" id="editHelpArticleModalLabel">Edit Help Article</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editHelpArticleForm">
                        <input type="hidden" id="editHelpArticleId">
                        <div class="mb-3">
                            <label for="editHelpTitle" class="form-label">Title</label>
                            <input type="text" class="form-control bg-dark" id="editHelpTitle" required>
                        </div>
                        <div class="mb-3">
                            <label for="editHelpCategory" class="form-label">Category</label>
                            <select class="form-select bg-dark" id="editHelpCategory" required>
                                <option value="Account Setup">Account Setup</option>
                                <option value="Trading">Trading</option>
                                <option value="Payments">Payments</option>
                                <option value="Technical">Technical</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editHelpAudience" class="form-label">Audience</label>
                            <select class="form-select bg-dark" id="editHelpAudience" required>
                                <option value="Investor">Investor</option>
                                <option value="Broker">Broker</option>
                                <option value="Both">Both</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editHelpContent" class="form-label">Content</label>
                            <textarea class="form-control bg-dark" id="editHelpContent" rows="5" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Update Article</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Learn Content Modal -->
    <div class="modal fade" id="addLearnArticleModal" tabindex="-1" aria-labelledby="addLearnArticleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-dark">
                <div class="modal-header">
                    <h5 class="modal-title" id="addLearnArticleModalLabel">Add Learn Content</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addLearnArticleForm">
                        <div class="mb-3">
                            <label for="learnTitle" class="form-label">Title</label>
                            <input type="text" class="form-control bg-dark" id="learnTitle" required>
                        </div>
                        <div class="mb-3">
                            <label for="learnCategory" class="form-label">Category</label>
                            <select class="form-select bg-dark" id="learnCategory" required>
                                <option value="Beginner">Beginner</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Advanced">Advanced</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="learnContent" class="form-label">Content</label>
                            <textarea class="form-control bg-dark" id="learnContent" rows="5" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="learnImage" class="form-label">Upload Image (Optional)</label>
                            <input type="file" class="form-control bg-dark" id="learnImage" accept=".jpg,.png">
                        </div>
                        <button type="submit" class="btn btn-primary">Add Content</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Learn Content Modal -->
    <div class="modal fade" id="editLearnArticleModal" tabindex="-1" aria-labelledby="editLearnArticleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-dark">
                <div class="modal-header">
                    <h5 class="modal-title" id="editLearnArticleModalLabel">Edit Learn Content</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editLearnArticleForm">
                        <input type="hidden" id="editLearnArticleId">
                        <div class="mb-3">
                            <label for="editLearnTitle" class="form-label">Title</label>
                            <input type="text" class="form-control bg-dark" id="editLearnTitle" required>
                        </div>
                        <div class="mb-3">
                            <label for="editLearnCategory" class="form-label">Category</label>
                            <select class="form-select bg-dark" id="editLearnCategory" required>
                                <option value="Beginner">Beginner</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Advanced">Advanced</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editLearnContent" class="form-label">Content</label>
                            <textarea class="form-control bg-dark" id="editLearnContent" rows="5" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="editLearnImage" class="form-label">Upload Image (Optional)</label>
                            <input type="file" class="form-control bg-dark" id="editLearnImage" accept=".jpg,.png">
                        </div>
                        <button type="submit" class="btn btn-primary">Update Content</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Review KYC Modal -->
<div class="modal fade" id="reviewKYCModal" tabindex="-1" aria-labelledby="reviewKYCModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content bg-dark">
            <div class="modal-header">
                <h5 class="modal-title" id="reviewKYCModalLabel">Review KYC Details</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="reviewKYCForm">
                    <input type="hidden" id="kycUserId">
                    <div class="mb-3">
                        <label for="kycName" class="form-label">Name</label>
                        <input type="text" class="form-control bg-dark" id="kycName" readonly>
                    </div>
                    <div class="mb-3">
                        <label for="kycStatus" class="form-label">Status</label>
                        <select class="form-select bg-dark" id="kycStatus" required>
                            <option value="Pending">Pending</option>
                            <option value="Verified">Verified</option>
                            <option value="Rejected">Rejected</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="kycFlags" class="form-label">Flags</label>
                        <input type="text" class="form-control bg-dark" id="kycFlags" readonly>
                    </div>
                    <div class="mb-3">
                        <label for="kycDetails" class="form-label">Details</label>
                        <textarea class="form-control bg-dark" id="kycDetails" rows="4" readonly></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="kycComments" class="form-label">Admin Comments</label>
                        <textarea class="form-control bg-dark" id="kycComments" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Update KYC</button>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Review Sanctions Modal -->
<div class="modal fade" id="reviewSanctionsModal" tabindex="-1" aria-labelledby="reviewSanctionsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content bg-dark">
            <div class="modal-header">
                <h5 class="modal-title" id="reviewSanctionsModalLabel">Review Sanctions Flagged User</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="reviewSanctionsForm">
                    <input type="hidden" id="sanctionsUserId">
                    <div class="mb-3">
                        <label for="sanctionsName" class="form-label">Name</label>
                        <input type="text" class="form-control bg-dark" id="sanctionsName" readonly>
                    </div>
                    <div class="mb-3">
                        <label for="sanctionsFlagType" class="form-label">Flag Type</label>
                        <input type="text" class="form-control bg-dark" id="sanctionsFlagType" readonly>
                    </div>
                    <div class="mb-3">
                        <label for="sanctionsDetails" class="form-label">Details</label>
                        <textarea class="form-control bg-dark" id="sanctionsDetails" rows="4" readonly></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="sanctionsAction" class="form-label">Action</label>
                        <select class="form-select bg-dark" id="sanctionsAction" required>
                            <option value="Clear">Clear</option>
                            <option value="Suspend">Suspend</option>
                            <option value="Ban">Ban</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="sanctionsComments" class="form-label">Admin Comments</label>
                        <textarea class="form-control bg-dark" id="sanctionsComments" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Update Status</button>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- Settings Confirmation Modal -->
<div class="modal fade" id="settingsConfirmationModal" tabindex="-1" aria-labelledby="settingsConfirmationModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content bg-dark">
            <div class="modal-header">
                <h5 class="modal-title" id="settingsConfirmationModalLabel">Confirm Settings Update</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p id="confirmationMessage">Are you sure you want to update these settings?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="confirmSettingsUpdate"><i class="bi bi-check-circle me-2"></i>Confirm</button>
            </div>
        </div>
    </div>
</div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Help articles (placeholder)
        const helpArticles = [
            { id: "H001", title: "How to Verify KYC", category: "Account Setup", audience: "Investor", content: "Steps to verify KYC...", updated: "2025-04-10" },
            { id: "H002", title: "Managing Client Orders", category: "Trading", audience: "Broker", content: "Guide to orders...", updated: "2025-04-09" }
        ];

        // Learn content (placeholder)
        const learnContent = [
            { id: "L001", title: "Introduction to Investing", category: "Beginner", content: "Basics of investing...", updated: "2025-04-08" },
            { id: "L002", title: "Understanding Stocks", category: "Intermediate", content: "Stock market guide...", updated: "2025-04-07" }
        ];

        // Navigation logic
        const sections = document.querySelectorAll(".content-section");
        const navItems = document.querySelectorAll(".nav-item");
        const dropdownItems = document.querySelectorAll(".dropdown-item");
        const moreIcon = document.getElementById("more-icon");

        function showSection(sectionId) {
            sections.forEach(section => {
                section.classList.remove("active");
                section.querySelector(".loading").style.display = "none";
            });
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.querySelector(".loading").style.display = "block";
                setTimeout(() => {
                    targetSection.querySelector(".loading").style.display = "none";
                    targetSection.classList.add("active");
                }, 300);
                window.scrollTo({ top: 0, behavior: "smooth" });
            }
            navItems.forEach(item => item.classList.remove("active"));
            document.querySelectorAll(`.nav-item[href="#${sectionId}"]`).forEach(item => item.classList.add("active"));
            dropdownItems.forEach(item => item.classList.remove("active"));
            document.querySelectorAll(`.dropdown-item[href="#${sectionId}"]`).forEach(item => item.classList.add("active"));
            moreIcon.classList.toggle("active", ["compliance", "learn", "help"].includes(sectionId));
            localStorage.setItem("lastSectionIndexAdmin", sectionId);
        }

        function handleNavClick(e) {
            e.preventDefault();
            const sectionId = e.target.closest("a").getAttribute("href").substring(1);
            showSection(sectionId);
            window.location.hash = sectionId;
        }

        navItems.forEach(item => item.addEventListener("click", handleNavClick));
        dropdownItems.forEach(item => item.addEventListener("click", handleNavClick));

        window.addEventListener("load", () => {
            const sectionId = window.location.hash.substring(1) || localStorage.getItem("lastSectionIndexAdmin") || "dashboard";
            showSection(sectionId);
        });

        window.addEventListener("hashchange", () => {
            showSection(window.location.hash.substring(1) || "dashboard");
        });

        // Help Article CRUD
        document.getElementById("addHelpArticleForm").addEventListener("submit", (e) => {
            e.preventDefault();
            const newArticle = {
                id: `H${(helpArticles.length + 1).toString().padStart(3, "0")}`,
                title: document.getElementById("helpTitle").value,
                category: document.getElementById("helpCategory").value,
                audience: document.getElementById("helpAudience").value,
                content: document.getElementById("helpContent").value,
                updated: new Date().toISOString().slice(0, 10)
            };
            helpArticles.push(newArticle);
            const helpTableBody = document.getElementById("helpTableBody");
            helpTableBody.innerHTML += `
                <tr data-article-id="${newArticle.id}">
                    <td>${newArticle.title}</td>
                    <td>${newArticle.category}</td>
                    <td>${newArticle.audience}</td>
                    <td>${newArticle.updated}</td>
                    <td>
                        <button class="btn btn-primary btn-sm me-1 edit-help-btn" data-bs-toggle="modal" data-bs-target="#editHelpArticleModal"><i class="bi bi-pencil"></i> Edit</button>
                        <button class="btn btn-danger btn-sm delete-help-btn"><i class="bi bi-trash"></i> Delete</button>
                    </td>
                </tr>
            `;
            bootstrap.Modal.getInstance(document.getElementById("addHelpArticleModal")).hide();
            document.getElementById("addHelpArticleForm").reset();
        });

        document.getElementById("helpTableBody").addEventListener("click", (e) => {
            const row = e.target.closest("tr");
            const articleId = row.dataset.articleId;
            if (e.target.closest(".edit-help-btn")) {
                const article = helpArticles.find(a => a.id === articleId);
                document.getElementById("editHelpArticleId").value = article.id;
                document.getElementById("editHelpTitle").value = article.title;
                document.getElementById("editHelpCategory").value = article.category;
                document.getElementById("editHelpAudience").value = article.audience;
                document.getElementById("editHelpContent").value = article.content;
            } else if (e.target.closest(".delete-help-btn")) {
                if (confirm("Are you sure you want to delete this article?")) {
                    helpArticles.splice(helpArticles.findIndex(a => a.id === articleId), 1);
                    row.remove();
                }
            }
        });

        document.getElementById("editHelpArticleForm").addEventListener("submit", (e) => {
            e.preventDefault();
            const articleId = document.getElementById("editHelpArticleId").value;
            const article = helpArticles.find(a => a.id === articleId);
            article.title = document.getElementById("editHelpTitle").value;
            article.category = document.getElementById("editHelpCategory").value;
            article.audience = document.getElementById("editHelpAudience").value;
            article.content = document.getElementById("editHelpContent").value;
            article.updated = new Date().toISOString().slice(0, 10);
            const row = document.querySelector(`tr[data-article-id="${articleId}"]`);
            row.innerHTML = `
                <td>${article.title}</td>
                <td>${article.category}</td>
                <td>${article.audience}</td>
                <td>${article.updated}</td>
                <td>
                    <button class="btn btn-primary btn-sm me-1 edit-help-btn" data-bs-toggle="modal" data-bs-target="#editHelpArticleModal"><i class="bi bi-pencil"></i> Edit</button>
                    <button class="btn btn-danger btn-sm delete-help-btn"><i class="bi bi-trash"></i> Delete</button>
                </td>
            `;
            bootstrap.Modal.getInstance(document.getElementById("editHelpArticleModal")).hide();
        });

        // Learn Content CRUD
        document.getElementById("addLearnArticleForm").addEventListener("submit", (e) => {
            e.preventDefault();
            const newContent = {
                id: `L${(learnContent.length + 1).toString().padStart(3, "0")}`,
                title: document.getElementById("learnTitle").value,
                category: document.getElementById("learnCategory").value,
                content: document.getElementById("learnContent").value,
                updated: new Date().toISOString().slice(0, 10)
            };
            learnContent.push(newContent);
            const learnTableBody = document.getElementById("learnTableBody");
            learnTableBody.innerHTML += `
                <tr data-content-id="${newContent.id}">
                    <td>${newContent.title}</td>
                    <td>${newContent.category}</td>
                    <td>${newContent.updated}</td>
                    <td>
                        <button class="btn btn-primary btn-sm me-1 edit-learn-btn" data-bs-toggle="modal" data-bs-target="#editLearnArticleModal"><i class="bi bi-pencil"></i> Edit</button>
                        <button class="btn btn-danger btn-sm delete-learn-btn"><i class="bi bi-trash"></i> Delete</button>
                    </td>
                </tr>
            `;
            bootstrap.Modal.getInstance(document.getElementById("addLearnArticleModal")).hide();
            document.getElementById("addLearnArticleForm").reset();
        });

        document.getElementById("learnTableBody").addEventListener("click", (e) => {
            const row = e.target.closest("tr");
            const contentId = row.dataset.contentId;
            if (e.target.closest(".edit-learn-btn")) {
                const content = learnContent.find(c => c.id === contentId);
                document.getElementById("editLearnArticleId").value = content.id;
                document.getElementById("editLearnTitle").value = content.title;
                document.getElementById("editLearnCategory").value = content.category;
                document.getElementById("editLearnContent").value = content.content;
            } else if (e.target.closest(".delete-learn-btn")) {
                if (confirm("Are you sure you want to delete this content?")) {
                    learnContent.splice(learnContent.findIndex(c => c.id === contentId), 1);
                    row.remove();
                }
            }
        });

        document.getElementById("editLearnArticleForm").addEventListener("submit", (e) => {
            e.preventDefault();
            const contentId = document.getElementById("editLearnArticleId").value;
            const content = learnContent.find(c => c.id === contentId);
            content.title = document.getElementById("editLearnTitle").value;
            content.category = document.getElementById("editLearnCategory").value;
            content.content = document.getElementById("editLearnContent").value;
            content.updated = new Date().toISOString().slice(0, 10);
            const row = document.querySelector(`tr[data-content-id="${contentId}"]`);
            row.innerHTML = `
                <td>${content.title}</td>
                <td>${content.category}</td>
                <td>${content.updated}</td>
                <td>
                    <button class="btn btn-primary btn-sm me-1 edit-learn-btn" data-bs-toggle="modal" data-bs-target="#editLearnArticleModal"><i class="bi bi-pencil"></i> Edit</button>
                    <button class="btn btn-danger btn-sm delete-learn-btn"><i class="bi bi-trash"></i> Delete</button>
                </td>
            `;
            bootstrap.Modal.getInstance(document.getElementById("editLearnArticleModal")).hide();
        });

        // Compliance Data (Placeholder)
const kycData = [
    { userId: "U001", name: "John Doe", status: "Verified", flags: "None", details: "ID and address verified", lastUpdated: "2025-04-15" },
    { userId: "U002", name: "Jane Smith", status: "Pending", flags: "Incomplete", details: "Missing address proof", lastUpdated: "2025-04-14" },
    { userId: "U003", name: "Bob Johnson", status: "Rejected", flags: "Suspicious", details: "Invalid ID document", lastUpdated: "2025-04-13" }
];

const sanctionsData = [
    { userId: "U002", name: "Jane Smith", flagType: "PEP", details: "Matched political figure list" },
    { userId: "U004", name: "Alice Brown", flagType: "Sanctions", details: "Matched OFAC sanctions list" }
];

const auditLogs = [
    { logId: "A001", adminId: "AD001", action: "KYC Approval", details: "Approved KYC for U001", timestamp: "2025-04-15 10:30:00" },
    { logId: "A002", adminId: "AD002", action: "Order Cancellation", details: "Cancelled order O123", timestamp: "2025-04-14 15:45:00" }
];

// Populate KYC Table
function populateKYCTable(data) {
    const kycTableBody = document.getElementById("kycTableBody");
    kycTableBody.innerHTML = "";
    data.forEach(user => {
        kycTableBody.innerHTML += `
            <tr data-user-id="${user.userId}">
                <td>${user.userId}</td>
                <td>${user.name}</td>
                <td><span class="badge ${user.status === 'Verified' ? 'bg-success' : user.status === 'Pending' ? 'bg-warning' : 'bg-danger'}">${user.status}</span></td>
                <td>${user.flags}</td>
                <td>${user.lastUpdated}</td>
                <td>
                    <button class="btn btn-primary btn-sm me-1 review-kyc-btn" data-bs-toggle="modal" data-bs-target="#reviewKYCModal"><i class="bi bi-eye"></i> Review</button>
                </td>
            </tr>
        `;
    });
    updateKYCCompletionRate();
}

// Update KYC Completion Rate
function updateKYCCompletionRate() {
    const verifiedCount = kycData.filter(user => user.status === "Verified").length;
    const completionRate = (verifiedCount / kycData.length * 100).toFixed(1);
    document.getElementById("kyc-completion-rate").textContent = `${completionRate}%`;
}

// Populate Sanctions Table
function populateSanctionsTable(data) {
    const sanctionsTableBody = document.getElementById("sanctionsTableBody");
    sanctionsTableBody.innerHTML = "";
    data.forEach(user => {
        sanctionsTableBody.innerHTML += `
            <tr data-user-id="${user.userId}">
                <td>${user.userId}</td>
                <td>${user.name}</td>
                <td><span class="badge bg-danger">${user.flagType}</span></td>
                <td>${user.details}</td>
                <td>
                    <button class="btn btn-primary btn-sm review-sanctions-btn" data-bs-toggle="modal" data-bs-target="#reviewSanctionsModal"><i class="bi bi-eye"></i> Review</button>
                </td>
            </tr>
        `;
    });
}

// Populate Audit Table
function populateAuditTable(data) {
    const auditTableBody = document.getElementById("auditTableBody");
    auditTableBody.innerHTML = "";
    data.forEach(log => {
        auditTableBody.innerHTML += `
            <tr data-log-id="${log.logId}">
                <td>${log.logId}</td>
                <td>${log.adminId}</td>
                <td>${log.action}</td>
                <td>${log.details}</td>
                <td>${log.timestamp}</td>
            </tr>
        `;
    });
}

// Search Functionality
function setupSearch(inputId, tableId, tableBodyId) {
    const searchInput = document.querySelector(`.${inputId}`);
    searchInput.addEventListener("input", () => {
        const query = searchInput.value.toLowerCase();
        const rows = document.querySelectorAll(`#${tableBodyId} tr`);
        rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            row.style.display = text.includes(query) ? "" : "none";
        });
    });
}

// KYC Review Modal
document.getElementById("kycTableBody").addEventListener("click", (e) => {
    if (e.target.closest(".review-kyc-btn")) {
        const row = e.target.closest("tr");
        const userId = row.dataset.userId;
        const user = kycData.find(u => u.userId === userId);
        document.getElementById("kycUserId").value = user.userId;
        document.getElementById("kycName").value = user.name;
        document.getElementById("kycStatus").value = user.status;
        document.getElementById("kycFlags").value = user.flags;
        document.getElementById("kycDetails").value = user.details;
        document.getElementById("kycComments").value = "";
    }
});

document.getElementById("reviewKYCForm").addEventListener("submit", (e) => {
    e.preventDefault();
    const userId = document.getElementById("kycUserId").value;
    const user = kycData.find(u => u.userId === userId);
    user.status = document.getElementById("kycStatus").value;
    user.lastUpdated = new Date().toISOString().slice(0, 10);
    const comments = document.getElementById("kycComments").value;
    if (comments) user.details += `\nAdmin Comment: ${comments}`;
    populateKYCTable(kycData);
    bootstrap.Modal.getInstance(document.getElementById("reviewKYCModal")).hide();
    logAuditAction("AD001", "KYC Update", `Updated KYC status for ${userId} to ${user.status}`);
});

// Sanctions Review Modal
document.getElementById("sanctionsTableBody").addEventListener("click", (e) => {
    if (e.target.closest(".review-sanctions-btn")) {
        const row = e.target.closest("tr");
        const userId = row.dataset.userId;
        const user = sanctionsData.find(u => u.userId === userId);
        document.getElementById("sanctionsUserId").value = user.userId;
        document.getElementById("sanctionsName").value = user.name;
        document.getElementById("sanctionsFlagType").value = user.flagType;
        document.getElementById("sanctionsDetails").value = user.details;
        document.getElementById("sanctionsAction").value = "Clear";
        document.getElementById("sanctionsComments").value = "";
    }
});

document.getElementById("reviewSanctionsForm").addEventListener("submit", (e) => {
    e.preventDefault();
    const userId = document.getElementById("sanctionsUserId").value;
    const action = document.getElementById("sanctionsAction").value;
    const comments = document.getElementById("sanctionsComments").value;
    if (action === "Clear") {
        const index = sanctionsData.findIndex(u => u.userId === userId);
        sanctionsData.splice(index, 1);
    } else {
        const user = sanctionsData.find(u => u.userId === userId);
        user.details += `\nAction: ${action}${comments ? `, Comment: ${comments}` : ""}`;
    }
    populateSanctionsTable(sanctionsData);
    bootstrap.Modal.getInstance(document.getElementById("reviewSanctionsModal")).hide();
    logAuditAction("AD001", "Sanctions Update", `Updated sanctions status for ${userId} to ${action}`);
});

// Report Generation
document.getElementById("reportForm").addEventListener("submit", (e) => {
    e.preventDefault();
    const reportType = document.getElementById("reportType").value;
    const reportFormat = document.getElementById("reportFormat").value;
    let data;
    switch (reportType) {
        case "transactions":
            data = [{ id: "T001", amount: 1000, date: "2025-04-15" }]; // Placeholder
            break;
        case "orders":
            data = [{ id: "O001", symbol: "AAPL", quantity: 10, date: "2025-04-15" }]; // Placeholder
            break;
        case "user-activity":
            data = [{ userId: "U001", action: "Login", date: "2025-04-15" }]; // Placeholder
            break;
        case "compliance":
            data = kycData.concat(sanctionsData.map(u => ({ userId: u.userId, name: u.name, status: "Flagged", details: u.details })));
            break;
    }
    if (reportFormat === "csv") {
        const csv = convertToCSV(data);
        downloadFile(csv, `${reportType}-report.csv`, "text/csv");
    } else {
        alert("PDF generation requires server-side processing. Please implement a backend service.");
    }
    logAuditAction("AD001", "Report Generation", `Generated ${reportType} report in ${reportFormat}`);
});

// CSV Conversion and Download
function convertToCSV(data) {
    const headers = Object.keys(data[0]).join(",");
    const rows = data.map(obj => Object.values(obj).join(",")).join("\n");
    return `${headers}\n${rows}`;
}

function downloadFile(content, fileName, mimeType) {
    const blob = new Blob([content], { type: mimeType });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = fileName;
    a.click();
    URL.revokeObjectURL(url);
}

// Audit Logging
function logAuditAction(adminId, action, details) {
    const log = {
        logId: `A${(auditLogs.length + 1).toString().padStart(3, "0")}`,
        adminId,
        action,
        details,
        timestamp: new Date().toISOString().replace("T", " ").slice(0, 19)
    };
    auditLogs.push(log);
    populateAuditTable(auditLogs);
}

// Initialize Compliance Section
function initCompliance() {
    populateKYCTable(kycData);
    populateSanctionsTable(sanctionsData);
    populateAuditTable(auditLogs);
    setupSearch("kyc-search", "kycTable", "kycTableBody");
    setupSearch("sanctions-search", "sanctionsTable", "sanctionsTableBody");
    setupSearch("audit-search", "auditTable", "auditTableBody");
}

// Call initCompliance when Compliance section is shown
document.querySelector('.dropdown-item[href="#compliance"]').addEventListener("click", initCompliance);
document.querySelector('.nav-item[href="#compliance"]').addEventListener("click", initCompliance);
  
  // Settings Data (Placeholder)
const settingsData = {
    commission: {
        brokerCommission: 0.5,
        orderFee: 1.00,
        vatTax: 5.0,
        capitalGainsTax: 15.0
    },
    limits: {
        maxOrderSize: 100000,
        dailyVolume: 500000,
        ordersPerDay: 50,
        transfersPerDay: 5,
        transactionVolume: 10000,
        transactionValue: 5000
    },
    notifications: {
        "kyc-status": { admin: true, broker: false, investor: true },
        "order-updates": { admin: false, broker: true, investor: true },
        "transfers": { admin: true, broker: false, investor: true },
        "user-queries": { admin: true, broker: true, investor: false }
    },
    kycLevels: {
        requiredDocuments: ["id", "address"],
        fileFormats: ["pdf", "jpg", "png"],
        validityPeriod: 180,
        verificationThreshold: 80,
        maxFileSize: 5
    }
};

// Initialize Settings Forms
function initSettings() {
    // Commission Rates
    document.getElementById("brokerCommission").value = settingsData.commission.brokerCommission;
    document.getElementById("orderFee").value = settingsData.commission.orderFee;
    document.getElementById("vatTax").value = settingsData.commission.vatTax;
    document.getElementById("capitalGainsTax").value = settingsData.commission.capitalGainsTax;

    // Trading and Transfer Limits
    document.getElementById("maxOrderSize").value = settingsData.limits.maxOrderSize;
    document.getElementById("dailyVolume").value = settingsData.limits.dailyVolume;
    document.getElementById("ordersPerDay").value = settingsData.limits.ordersPerDay;
    document.getElementById("transfersPerDay").value = settingsData.limits.transfersPerDay;
    document.getElementById("transactionVolume").value = settingsData.limits.transactionVolume;
    document.getElementById("transactionValue").value = settingsData.limits.transactionValue;

    // Notification Settings
    const notificationTableBody = document.getElementById("notificationTableBody");
    notificationTableBody.querySelectorAll(".notification-toggle").forEach(toggle => {
        const type = toggle.closest("tr").dataset.notificationType;
        const role = toggle.dataset.role;
        toggle.checked = settingsData.notifications[type][role];
    });

    // KYC Levels
    const requiredDocuments = document.getElementById("requiredDocuments");
    const fileFormats = document.getElementById("fileFormats");
    requiredDocuments.querySelectorAll("option").forEach(opt => {
        opt.selected = settingsData.kycLevels.requiredDocuments.includes(opt.value);
    });
    fileFormats.querySelectorAll("option").forEach(opt => {
        opt.selected = settingsData.kycLevels.fileFormats.includes(opt.value);
    });
    document.getElementById("validityPeriod").value = settingsData.kycLevels.validityPeriod;
    document.getElementById("verificationThreshold").value = settingsData.kycLevels.verificationThreshold;
    document.getElementById("maxFileSize").value = settingsData.kycLevels.maxFileSize;
}

// Commission Rates Form
document.getElementById("commissionForm").addEventListener("submit", (e) => {
    e.preventDefault();
    const newSettings = {
        brokerCommission: parseFloat(document.getElementById("brokerCommission").value),
        orderFee: parseFloat(document.getElementById("orderFee").value),
        vatTax: parseFloat(document.getElementById("vatTax").value),
        capitalGainsTax: parseFloat(document.getElementById("capitalGainsTax").value)
    };
    showConfirmationModal("Update Commission Rates?", () => {
        settingsData.commission = newSettings;
        initSettings();
        logAuditAction("AD001", "Commission Update", `Updated commission rates: ${JSON.stringify(newSettings)}`);
        alert("Commission rates updated successfully!");
    });
});

// Trading and Transfer Limits Form
document.getElementById("limitsForm").addEventListener("submit", (e) => {
    e.preventDefault();
    const newSettings = {
        maxOrderSize: parseInt(document.getElementById("maxOrderSize").value),
        dailyVolume: parseInt(document.getElementById("dailyVolume").value),
        ordersPerDay: parseInt(document.getElementById("ordersPerDay").value),
        transfersPerDay: parseInt(document.getElementById("transfersPerDay").value),
        transactionVolume: parseInt(document.getElementById("transactionVolume").value),
        transactionValue: parseInt(document.getElementById("transactionValue").value)
    };
    showConfirmationModal("Update Trading and Transfer Limits?", () => {
        settingsData.limits = newSettings;
        initSettings();
        logAuditAction("AD001", "Limits Update", `Updated limits: ${JSON.stringify(newSettings)}`);
        alert("Limits updated successfully!");
    });
});

// Notification Settings
document.getElementById("saveNotifications").addEventListener("click", () => {
    const newSettings = {};
    document.querySelectorAll("#notificationTableBody tr").forEach(row => {
        const type = row.dataset.notificationType;
        newSettings[type] = {
            admin: row.querySelector('input[data-role="admin"]').checked,
            broker: row.querySelector('input[data-role="broker"]').checked,
            investor: row.querySelector('input[data-role="investor"]').checked
        };
    });
    showConfirmationModal("Update Notification Settings?", () => {
        settingsData.notifications = newSettings;
        initSettings();
        logAuditAction("AD001", "Notifications Update", `Updated notifications: ${JSON.stringify(newSettings)}`);
        alert("Notification settings updated successfully!");
    });
});

// KYC Levels Form
document.getElementById("kycLevelsForm").addEventListener("submit", (e) => {
    e.preventDefault();
    const newSettings = {
        requiredDocuments: Array.from(document.getElementById("requiredDocuments").selectedOptions).map(opt => opt.value),
        fileFormats: Array.from(document.getElementById("fileFormats").selectedOptions).map(opt => opt.value),
        validityPeriod: parseInt(document.getElementById("validityPeriod").value),
        verificationThreshold: parseInt(document.getElementById("verificationThreshold").value),
        maxFileSize: parseInt(document.getElementById("maxFileSize").value)
    };
    showConfirmationModal("Update KYC Levels?", () => {
        settingsData.kycLevels = newSettings;
        initSettings();
        logAuditAction("AD001", "KYC Levels Update", `Updated KYC levels: ${JSON.stringify(newSettings)}`);
        alert("KYC levels updated successfully!");
    });
});

// Confirmation Modal
function showConfirmationModal(message, onConfirm) {
    document.getElementById("confirmationMessage").textContent = message;
    const modal = new bootstrap.Modal(document.getElementById("settingsConfirmationModal"));
    const confirmBtn = document.getElementById("confirmSettingsUpdate");
    const handler = () => {
        onConfirm();
        modal.hide();
        confirmBtn.removeEventListener("click", handler);
    };
    confirmBtn.addEventListener("click", handler);
    modal.show();
}

// Initialize Settings Section
function initSettingsSection() {
    initSettings();
}

// Call initSettingsSection when Settings section is shown
document.querySelector('.nav-item[href="#settings"]').addEventListener("click", initSettingsSection);
document.querySelector('.dropdown-item[href="#settings"]').addEventListener("click", initSettingsSection);


  </script>
</body>

</html>


